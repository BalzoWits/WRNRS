<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Pesca una Carta</title>
  <style>
    body {
      font-family: 'Helvetica Neue', sans-serif;
      background-color: #f9f9f9;
      text-align: center;
      padding: 2rem;
      color: #333;
    }

    .hidden {
      display: none;
    }

    h1 {
      color: #c0392b;
      font-weight: bold;
    }

    .button {
      padding: 0.8rem 1.5rem;
      font-size: 1.1rem;
      margin: 1rem;
      border: none;
      border-radius: 0.5rem;
      background-color: #c0392b;
      color: white;
      cursor: pointer;
    }

    .button.level {
      background-color: white;
      border: 2px solid #c0392b;
      color: #c0392b;
    }

    .button.level.active {
      background-color: #c0392b;
      color: white;
    }

    .card {
      border: 2px solid #c0392b;
      border-radius: 1rem;
      padding: 2rem;
      margin: 1rem auto;
      width: 90%;
      max-width: 600px;
      background-color: white;
      font-size: 1.3rem;
      color: #c0392b;
      font-weight: bold;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }

    #status {
      margin-top: 1rem;
      color: #777;
    }
  </style>
</head>
<body>
  <div id="startScreen">
    <h1>Benvenuto!</h1>
    <button class="button" id="loadCSVButton">Carica file CSV</button>
    <input type="file" id="csvInput" accept=".csv" class="hidden" />
    <br>
    <button class="button" id="startButton">Inizia a giocare</button>
  </div>

  <div id="gameScreen" class="hidden">
    <h1>Pesca una Carta</h1>

    <div>
      <button class="button level" data-level="1">Livello 1</button>
      <button class="button level" data-level="2">Livello 2</button>
      <button class="button level" data-level="3">Livello 3</button>
    </div>

    <button class="button" id="drawCardButton">Pesca prossima carta</button>

    <div>
      <h3>Carta attuale:</h3>
      <div class="card" id="currentCard">—</div>
    </div>

    <div>
      <h3>Carta precedente:</h3>
      <div class="card" id="previousCard">—</div>
    </div>

    <div id="status">Carica un file o inizia per giocare.</div>
  </div>

  <script>
    let allCards = {1: [], 2: [], 3: []};
    let usedCards = {1: [], 2: [], 3: []};
    let currentLevel = 1;

    const defaultQuestions = {
      1: [
        "Do I look kind?",
        "What was your first impression of me?",
        "What do you think my go-to karaoke song is?",
        "Do you think I’m more of a morning or night person?",
        "Do I seem like more of a creative or analytical type?",
        "What’s your favorite type of music?",
        "What’s the first thing you noticed about me?",
        "What do you think is my favorite season and why?",
        "What’s something you think we have in common?",
        "What color do you associate with me?",
        "Do you think I was popular in school?",
        "What’s a fashion trend you think I follow?",
        "What’s something you think I’m good at?",
        "Do you think I prefer coffee or tea?",
        "Would you rather go on a road trip or fly somewhere with me?",
        "What do you think I do to relax?",
        "Do you think I’m more introverted or extroverted?",
        "What’s your guess at my zodiac sign?",
        "What show do you think I binge watched last?",
        "If we met as kids, what would our relationship be like?",
        "What animal do you think I’d be?",
        "Do you think I prefer books or movies?",
        "Do I seem like someone who plans things or goes with the flow?",
        "Do you think I like surprises?",
        "What’s your favorite memory involving me?",
        "What’s my communication style like?",
        "If I were a drink, what would I be?",
        "Do you think I believe in love at first sight?",
        "What role do you think I had in group projects?",
        "Do I seem like someone who takes risks?",
        "What’s a small thing that makes me smile?",
        "If I had a warning label, what would it say?",
        "What’s your favorite thing about the way I look?",
        "What do you think is my love language?",
        "Do you think I overthink things?",
        "What emoji represents me best?",
        "How do I show I’m upset?",
        "What’s something you want to ask me but haven’t yet?",
        "If my life were a movie, what genre would it be?",
        "How do I handle stress?",
        "Do I come off as more optimistic or pessimistic?",
        "What do you think my ideal weekend looks like?",
        "What’s a song that reminds you of me?",
        "Do you think I enjoy alone time?",
        "What do you think my biggest strength is?",
        "Do I seem more confident or humble?",
        "What’s my sense of humor like?",
        "If we switched lives for a day, what would you do first?",
        "Do I seem like someone who’s good at keeping secrets?",
        "Do I seem approachable or intimidating?"
      ],
      2: [
        "What’s the most pain you’ve ever been in that wasn’t physical?",
        "When was the last time you felt vulnerable?",
        "What part of your life works? What part of your life hurts?",
        "What’s something you’re not telling anyone?",
        "What lesson took you the longest to unlearn?",
        "Are you more afraid of failure or success?",
        "What’s been your happiest memory this past year?",
        "What’s one dream you’ve let go of?",
        "What’s something you need to let go of?",
        "What are you still trying to prove to yourself?",
        "What’s your most toxic trait you’re willing to admit?",
        "When was the last time you felt truly understood?",
        "What insecurity of yours holds you back the most?",
        "What would you define as a turning point in your life?",
        "What’s a moment you wish you could relive?",
        "What does love feel like to you?",
        "Do you think your childhood affects your relationships?",
        "What’s your relationship like with yourself?",
        "What’s the best compliment you’ve ever received?",
        "How do you feel about vulnerability?",
        "What emotion do you try to avoid the most?",
        "What’s a belief you hold that many people disagree with?",
        "When do you feel most at peace?",
        "Have you ever felt like you were not enough?",
        "How do you define self-worth?",
        "What’s something that’s been on your mind lately?",
        "Do you think you’re hard on yourself?",
        "What would you say to your younger self?",
        "What’s a boundary you wish you had set earlier?",
        "What does forgiveness mean to you?",
        "What fear have you outgrown?",
        "What’s a compliment you struggle to accept?",
        "What do you need right now, more than anything?",
        "What part of yourself are you most proud of?",
        "When was the last time you truly felt alive?",
        "What’s a risk you wish you had taken?",
        "What makes you feel loved?",
        "When was the last time you cried?",
        "What memory instantly makes you smile?",
        "What’s something you’re afraid to admit?",
        "What do you think people misunderstand about you?",
        "What story are you telling yourself right now?",
        "What’s something you’ve never told anyone?",
        "Do you think people see you the way you see yourself?",
        "What’s something you wish people knew about you?",
        "What’s something you learned the hard way?",
        "What’s a promise you want to keep to yourself?",
        "What title would you give this chapter of your life?",
        "What does healing look like for you?",
        "What do you want to be remembered for?"
      ],
      3: [
        "What do you think my weakness is?",
        "How do our personalities complement each other?",
        "What’s one thing I do that makes you feel seen?",
        "What do you admire most about me?",
        "What do you think I fear the most?",
        "When do you feel closest to me?",
        "What have you learned from me?",
        "What do you think I should know about myself that perhaps I’m unaware of?",
        "What’s something you’ve been meaning to say to me but haven’t?",
        "What’s one experience you think changed me?",
        "If you could relive one moment with me, what would it be?",
        "How have I changed you?",
        "What’s a lesson our friendship has taught you?",
        "What’s the most honest thing you’ve ever said to me?",
        "What would you want me to remember forever?",
        "What’s the hardest part of being my friend?",
        "What’s the most courageous thing you’ve seen me do?",
        "What do you think I struggle with the most?",
        "What’s your favorite memory of us?",
        "What do I need to hear right now?",
        "What would you say is my superpower?",
        "When do I inspire you the most?",
        "How do I show I care?",
        "What would you want to thank me for?",
        "If this were our last conversation, what’s one thing you’d want me to know?",
        "How do you describe me to other people?",
        "What have I helped you appreciate about yourself?",
        "What’s something you hope never changes between us?",
        "What would make you feel closer to me?",
        "What part of me do you see in yourself?",
        "How do you think I handle conflict?",
        "What do you think my defining characteristic is?",
        "What have you been hesitant to tell me?",
        "What do you think my happiest moment was this year?",
        "If you wrote a song about me, what would it be called?",
        "What’s something I don’t give myself enough credit for?",
        "How do you know I’m truly listening?",
        "What would you change about our relationship?",
        "What’s the best gift I’ve given you?",
        "What’s something you want to do together that we haven’t yet?",
        "What do you think my legacy will be?",
        "What’s the kindest thing I’ve done for you?",
        "What do you think is the biggest challenge in my life right now?",
        "What moment in our relationship changed everything?",
        "What do you think I’m still learning?",
        "What do you want me to teach you?",
        "If I were a book, what would the title be?",
        "What’s something I’ve said that stuck with you?",
        "How do you feel when we’re apart?",
        "What do you want me to know, even if it’s hard to say?"
      ]
    };

    // Inserisci qui tutte le domande che già avevi

    function loadCSV() {
      document.getElementById('csvInput').click();
    }

    function startWithDefault() {
      allCards = JSON.parse(JSON.stringify(defaultQuestions));
      usedCards = {1: [], 2: [], 3: []};
      showGameScreen();
    }

    function parseCSV(text) {
      const lines = text.trim().split("\n").slice(1);
      allCards = {1: [], 2: [], 3: []};
      usedCards = {1: [], 2: [], 3: []};

      for (let line of lines) {
        const [levelStr, question] = line.split(/,(.+)/);
        const level = parseInt(levelStr.trim());
        if ([1, 2, 3].includes(level) && question) {
          allCards[level].push(question.trim());
        }
      }
      updateStatus();
    }

    function showGameScreen() {
      document.getElementById('startScreen').classList.add('hidden');
      document.getElementById('gameScreen').classList.remove('hidden');
      updateLevelButtons();
      updateStatus();
    }

    function setLevel(level) {
      currentLevel = level;
      updateLevelButtons();
      updateStatus();
    }

    function updateLevelButtons() {
      document.querySelectorAll('.button.level').forEach(btn => {
        btn.classList.remove('active');
        if (parseInt(btn.getAttribute('data-level')) === currentLevel) {
          btn.classList.add('active');
        }
      });
    }

    function drawCard() {
      const available = allCards[currentLevel];
      if (!available || available.length === 0) {
        alert("Non ci sono più carte per il livello " + currentLevel);
        return;
      }
      const index = Math.floor(Math.random() * available.length);
      const cardText = available.splice(index, 1)[0];
      usedCards[currentLevel].push(cardText);

      document.getElementById('previousCard').textContent = document.getElementById('currentCard').textContent;
      document.getElementById('currentCard').textContent = cardText;
      updateStatus();
    }

    function updateStatus() {
      const remaining = allCards[currentLevel]?.length ?? 0;
      const used = usedCards[currentLevel]?.length ?? 0;
      document.getElementById('status').textContent = `Livello ${currentLevel} — Carte rimanenti: ${remaining}, pescate: ${used}`;
    }

    document.addEventListener("DOMContentLoaded", function () {
      document.getElementById("startButton").addEventListener("click", startWithDefault);
      document.getElementById("loadCSVButton").addEventListener("click", loadCSV);
      document.getElementById("csvInput").addEventListener("change", function(event) {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(e) {
            parseCSV(e.target.result);
            showGameScreen();
          };
          reader.readAsText(file);
        }
      });

      document.querySelectorAll(".button.level").forEach(btn => {
        btn.addEventListener("click", () => {
          setLevel(parseInt(btn.getAttribute("data-level")));
        });
      });

      document.getElementById("drawCardButton").addEventListener("click", drawCard);
    });
  </script>
</body>
</html>
